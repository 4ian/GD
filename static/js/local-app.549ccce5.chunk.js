(this["webpackJsonpgdevelop-ide"]=this["webpackJsonpgdevelop-ide"]||[]).push([[4],{193:function(e,t,r){"use strict";(function(e){var n=r(6),o=r.n(n),a=o()("fs-extra"),i=o()("path"),s=o()("os");const c=e.gd;t.a={mkDir:function(e){try{a.mkdirsSync(e)}catch(t){return console.error("mkDir("+e+") failed: "+t),!1}return!0},dirExists:function(e){return a.existsSync(e)},clearDir:function(e){try{a.emptyDirSync(e)}catch(t){console.error("clearDir("+e+") failed: "+t)}},getTempDir:function(){return s.tmpdir()},fileNameFrom:function(e){return this._isExternalUrl(e)?e:(e=this._translateUrl(e),i.basename(e))},dirNameFrom:function(e){return this._isExternalUrl(e)?"":(e=this._translateUrl(e),i.dirname(e).replace(/\\/g,"/"))},makeAbsolute:function(e,t){return this._isExternalUrl(e)?e:(e=this._translateUrl(e),this.isAbsolute(t)||(t=i.resolve(t)),i.resolve(t,i.normalize(e)).replace(/\\/g,"/"))},makeRelative:function(e,t){return this._isExternalUrl(e)?e:(e=this._translateUrl(e),i.relative(t,i.normalize(e)).replace(/\\/g,"/"))},isAbsolute:function(e){return!!this._isExternalUrl(e)||(0===e.length||((e=this._translateUrl(e)).length>0&&"/"===e.charAt(0)||e.length>1&&":"===e.charAt(1)))},copyFile:function(e,t){if(this._isExternalUrl(e))return!0;e=this._translateUrl(e);try{e!==t&&a.copySync(e,t)}catch(r){return console.error("copyFile("+e+", "+t+") failed: "+r),!1}return!0},writeToFile:function(e,t){try{a.outputFileSync(e,t)}catch(r){return console.error("writeToFile("+e+", ...) failed: "+r),!1}return!0},readFile:function(e){try{return a.readFileSync(e).toString()}catch(t){return console.error("readFile("+e+") failed: "+t),""}},readDir:function(e,t){t=t.toUpperCase();var r=new c.VectorString;try{a.existsSync(e)&&a.readdirSync(e).forEach((function(n){0!==t.length&&-1===n.toUpperCase().indexOf(t,n.length-t.length)||r.push_back(e+"/"+n)}))}catch(n){console.error("readDir("+e+","+t+") failed: "+n)}return r},fileExists:function(e){e=this._translateUrl(e);try{return a.statSync(e).isFile()}catch(t){return!1}},_isExternalUrl:function(e){return e.startsWith("http://")||e.startsWith("https://")||e.startsWith("ftp://")},_translateUrl:function(e){return"g/"!==e.substr(0,2)&&"g\\"!==e.substr(0,2)||(e=e.substr(2)),e}}}).call(this,r(1))},1931:function(e,t,r){"use strict";(function(e){r.d(t,"b",(function(){return P})),r.d(t,"c",(function(){return S})),r.d(t,"a",(function(){return j}));var n=r(77),o=r(100),a=r.n(o),i=r(107),s=r(129),c=r(6),l=r.n(c),u=r(883),p=r(193),d=r(123),m=r.n(d);const h=e.gd,f=l()("fs-extra"),g=l()("path"),v=l()("electron"),b=v?v.remote.dialog:null,E=(e,t)=>{const r=performance.now();return new Promise((n,o)=>{f.readFile(e,{encoding:"utf8"},(a,i)=>{if(a)return o(a);""===i&&o(new Error("Written file is empty, did the write fail?")),i!==t&&o(new Error("Written file is not containing the expected content, did the write fail?"));const s=performance.now()-r;console.info("Verified ".concat(e," content in ").concat(s.toFixed(),"ms.")),n()})})},w=function(){var e=Object(i.a)(a.a.mark((function e(t,r){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(f){e.next=2;break}throw new Error("Filesystem is not supported.");case 2:if(""!==t){e.next=4;break}throw new Error("The content to save on disk is empty. Aborting.");case 4:return e.next=6,f.ensureDir(g.dirname(r));case 6:return e.next=8,f.writeFile(r,t);case 8:return e.next=10,E(r,t);case 10:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),x=function(){var e=Object(i.a)(a.a.mark((function e(t,r){var n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=JSON.stringify(t,null,2),e.next=3,w(n,r);case 3:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),y=(e,t,r)=>{const n=Object(s.b)(e);if(e.isFolderProject()){const e=Object(u.b)(n,{pathSeparator:"/",getArrayItemReferenceName:Object(u.a)("name"),shouldSplit:Object(u.c)(new Set(["/layouts/*","/externalLayouts/*","/externalEvents/*","/layouts/*","/eventsFunctionsExtensions/*"])),isReferenceMagicPropertyName:"__REFERENCE_TO_SPLIT_OBJECT"});return Promise.all(e.map(e=>x(e.object,g.join(r,e.reference)+".json").catch(e=>{throw console.error("Unable to write a partial file:",e),e}))).then(()=>x(n,t).catch(e=>{throw console.error("Unable to write the split project:",e),e}))}return x(n,t).catch(e=>{throw console.error("Unable to write the project:",e),e})},P=(e,t)=>{const r=t.fileIdentifier;if(!r)return Promise.reject('Project file is empty, "Save as" should have been called?');const n=g.dirname(r);return y(e,r,n).then(()=>({wasSaved:!0,fileMetadata:t}))},S=(e,t)=>{const r=t?t.fileIdentifier:"",o=m()(new h.AbstractFileSystemJS,p.a),a=v.remote.getCurrentWindow(),i={defaultPath:r,filters:[{name:"GDevelop 5 project",extensions:["json"]}]};if(!b)return Promise.reject("Unsupported");const s=b.showSaveDialogSync(a,i);if(!s)return Promise.resolve({wasSaved:!1,fileMetadata:t});const c=g.dirname(s);return h.ProjectResourcesCopier.copyAllResourcesTo(e,o,c,!0,!1,!0),e.setProjectFile(s),y(e,s,c).then(()=>({wasSaved:!0,fileMetadata:Object(n.a)(Object(n.a)({},t),{},{fileIdentifier:s})}))},j=(e,t)=>{const r=t.fileIdentifier+".autosave";return w(Object(s.a)(e),r).catch(e=>{throw console.error("Unable to write ".concat(r,":"),e),e})}}).call(this,r(1))},1944:function(e,t,r){"use strict";(function(e){r.d(t,"a",(function(){return O}));var n=r(71),o=r(4),a=r.n(o),i=r(2388),s=r(83),c=r(283),l=r(80),u=r(11),p=r(73),d=r(99),m=r(149),h=r(880),f=r(6),g=r.n(f),v=r(148),b=r(879),E=r(577),w=r(1945);const x=g()("path"),y=g()("electron"),P=y?y.remote.app:null;var S=g()("fs-extra");const j=e.gd;class O extends o.Component{createFromExample(e,t){const r=this.props.outputPath;S&&r&&Object(h.a)(n=>{try{S.mkdirsSync(r),S.copySync(x.join(n,t),r)}catch(o){return void Object(b.b)(e,r,o)}this.props.onOpen(E.a,{fileIdentifier:x.join(r,t+".json")}),Object(u.j)(t)})}createEmptyGame(e){const t=this.props.outputPath;if(!S||!t)return;try{S.mkdirsSync(t)}catch(o){return void Object(b.b)(e,t,o)}const r=j.ProjectHelper.createNewGDJSProject(),n=x.join(t,"game.json");r.setProjectFile(n),this.props.onCreate(r,E.a,{fileIdentifier:n}),Object(u.j)("")}componentDidMount(){""===this.props.outputPath&&x&&P&&this.props.onChangeOutputPath(Object(w.a)(x.join(P.getPath("documents"),"GDevelop projects")))}render(){return a.a.createElement(n.I18n,null,({i18n:e})=>a.a.createElement(p.a,{noMargin:!0},a.a.createElement(p.b,{expand:!0},a.a.createElement(p.a,{expand:!0},a.a.createElement(c.a,{fullWidth:!0,value:this.props.outputPath,onChange:this.props.onChangeOutputPath,type:"create-game"}))),a.a.createElement(i.a,null),a.a.createElement(p.b,null,a.a.createElement(p.a,null,a.a.createElement(l.a,null,a.a.createElement(n.Trans,{id:"Choose a game to use as a starter:"})))),a.a.createElement(p.b,null,a.a.createElement(p.a,{expand:!0,noMargin:!0},a.a.createElement(d.a,null,a.a.createElement(d.b,{leftIcon:a.a.createElement(v.a,{iconSize:40,src:"res/starters_icons/platformer.png"}),primaryText:a.a.createElement(n.Trans,{id:"Platformer"}),secondaryText:a.a.createElement(n.Trans,{id:"A simple platform game, with coins to collect, moving platforms and enemies."}),secondaryTextLines:2,onClick:()=>this.createFromExample(e,"platformer")}),a.a.createElement(d.b,{leftIcon:a.a.createElement(v.a,{iconSize:40,src:"res/starters_icons/space-shooter.png"}),primaryText:a.a.createElement(n.Trans,{id:"8-bit Space Shooter"}),secondaryText:a.a.createElement(n.Trans,{id:"A beautiful, retro side-scrolling shooter where you must defeat incoming enemies with your mecha transforming spaceship. Huge boss included!"}),secondaryTextLines:2,onClick:()=>this.createFromExample(e,"space-shooter")}),a.a.createElement(d.b,{leftIcon:a.a.createElement(v.a,{iconSize:40,src:"res/starters_icons/geometry-monster.png"}),primaryText:a.a.createElement(n.Trans,{id:"Geometry Monster"}),secondaryText:a.a.createElement(n.Trans,{id:"A hyper casual endless game where you have to collect shapes and avoid bombs, with a progressively increasing difficulty."}),secondaryTextLines:2,onClick:()=>this.createFromExample(e,"geometry-monster")}),a.a.createElement(d.b,{leftIcon:a.a.createElement(v.a,{iconSize:40,src:"res/starters_icons/isometric-game.png"}),primaryText:a.a.createElement(n.Trans,{id:"Isometric game"}),secondaryText:a.a.createElement(n.Trans,{id:"An example of an isometric game where you can explore a map with your character."}),secondaryTextLines:2,onClick:()=>this.createFromExample(e,"isometric-game")}),a.a.createElement(d.b,{leftIcon:a.a.createElement(v.a,{iconSize:40,src:"res/starters_icons/downhill-bike-physics-demo.png"}),primaryText:"Downhill Bike Racing",secondaryText:a.a.createElement(n.Trans,{id:"An example of a 2D physics based game, where players have to reach the end as fast as possible."}),secondaryTextLines:2,onClick:()=>this.createFromExample(e,"downhill-bike-physics-demo")}),a.a.createElement(d.b,{leftIcon:a.a.createElement(v.a,{iconSize:40,src:"res/starters_icons/pairs.png"}),primaryText:"Pairs",secondaryText:a.a.createElement(n.Trans,{id:"Find all matching pairs of cards in this relaxing game. Use tweens to create smooth, natural animations with a few events."}),secondaryTextLines:2,onClick:()=>this.createFromExample(e,"pairs")}),a.a.createElement(d.b,{leftIcon:a.a.createElement(v.a,{iconSize:40,src:"res/starters_icons/new.png"}),primaryText:a.a.createElement(n.Trans,{id:"Empty game"}),secondaryText:a.a.createElement(n.Trans,{id:"Start a new game from scratch."}),secondaryTextLines:2,onClick:()=>this.createEmptyGame(e)}),a.a.createElement(m.a,null,a.a.createElement(n.Trans,{id:"Advanced"})),a.a.createElement(d.b,{leftIcon:a.a.createElement(v.a,{iconSize:40,src:"res/starters_icons/particle-effects-demo.png"}),primaryText:a.a.createElement(n.Trans,{id:"Particle Effects Demo"}),secondaryText:a.a.createElement(n.Trans,{id:"A demo of various high quality particle effects (fire, magic, snow, rune spell...) that you can try and use in your game."}),secondaryTextLines:2,onClick:()=>this.createFromExample(e,"particle-effects-demo")}),a.a.createElement(d.b,{leftIcon:a.a.createElement(v.a,{iconSize:40,src:"res/starters_icons/game-feel-demo.png"}),primaryText:a.a.createElement(n.Trans,{id:"Game Feel Demo"}),secondaryText:a.a.createElement(n.Trans,{id:'A demo showing how to enhance the "game feel" of your project: VFX, shot trail, ambient sounds and SFX, screenshake, wobble...'}),secondaryTextLines:2,onClick:()=>this.createFromExample(e,"game-feel-demo")})),a.a.createElement(p.b,{alignItems:"center",justifyContent:"center"},a.a.createElement(s.a,{label:a.a.createElement(n.Trans,{id:"See examples"}),onClick:()=>this.props.onShowExamples()}))))))}}}).call(this,r(1))},1945:function(e,t,r){"use strict";r.d(t,"a",(function(){return c}));var n=r(122),o=r(6),a=r.n(o);const i=a()("path");var s=a()("fs-extra");const c=e=>{if(!i)return e;const t=Object(n.a)("My project",t=>{try{s.accessSync(i.join(e,t))}catch(r){return!1}return!0});return i.join(e,t)}},1946:function(e,t,r){"use strict";(function(e){var n,o,a,i,s,c=r(4),l=r(216),u=r(6),p=r.n(u),d=r(5);const m=p()("electron"),h=m?m.remote.dialog:null,f=p()("path"),g=e.gd;t.a=[{name:"localAudioFileOpener",displayName:"Choose a new audio file",kind:"audio",component:(n=class extends c.Component{constructor(...e){super(...e),this.chooseResources=(e,t=!0)=>{const r=this.props,n=r.i18n,o=r.getLastUsedPath,a=r.setLastUsedPath,i={multiSelections:t,title:n._({id:"Choose an audio file"}),name:n._({id:"Audio files"}),extensions:["aac","wav","mp3","ogg"]};return v(n,e,i,o,a,"audio").then(t=>t.map(t=>{const r=new g.AudioResource,n=f.dirname(e.getProjectFile());return r.setFile(f.relative(n,t)),r.setName(f.relative(n,t)),r}))}}render(){return null}},n)},{name:"localFileOpener",displayName:"Choose a new image",kind:"image",component:(o=class extends c.Component{constructor(...e){super(...e),this.chooseResources=(e,t=!0)=>{const r=this.props,n=r.i18n,o=r.getLastUsedPath,a=r.setLastUsedPath,i={multiSelections:t,title:n._({id:"Choose an image"}),name:n._({id:"Image files"}),extensions:["png","jpg"]};return v(n,e,i,o,a,"image").then(t=>t.map(t=>{const r=new g.ImageResource,n=f.dirname(e.getProjectFile());return r.setFile(f.relative(n,t)),r.setName(f.relative(n,t)),r}))}}render(){return null}},o)},{name:"localFontFileOpener",displayName:"Choose a new font file",kind:"font",component:(a=class extends c.Component{constructor(...e){super(...e),this.chooseResources=(e,t=!0)=>{const r=this.props,n=r.i18n,o=r.getLastUsedPath,a=r.setLastUsedPath,i={multiSelections:t,title:n._({id:"Choose a font file"}),name:n._({id:"Font files"}),extensions:["ttf","otf"]};return v(n,e,i,o,a,"font").then(t=>t.map(t=>{const r=new g.FontResource,n=f.dirname(e.getProjectFile());return r.setFile(f.relative(n,t)),r.setName(f.relative(n,t)),r}))}}render(){return null}},a)},{name:"localVideoFileOpener",displayName:"Choose a new video file",kind:"video",component:(i=class extends c.Component{constructor(...e){super(...e),this.chooseResources=(e,t=!0)=>{const r=this.props,n=r.i18n,o=r.getLastUsedPath,a=r.setLastUsedPath,i={multiSelections:t,title:n._({id:"Choose a video file"}),name:n._({id:"Video files"}),extensions:["mp4"]};return v(n,e,i,o,a,"video").then(t=>t.map(t=>{const r=new g.VideoResource,n=f.dirname(e.getProjectFile());return r.setFile(f.relative(n,t)),r.setName(f.relative(n,t)),r}))}}render(){return null}},i)},{name:"localJsonFileOpener",displayName:"Choose a new json file",kind:"json",component:(s=class extends c.Component{constructor(...e){super(...e),this.chooseResources=(e,t=!0)=>{const r=this.props,n=r.i18n,o=r.getLastUsedPath,a=r.setLastUsedPath,i={multiSelections:t,title:n._({id:"Choose a json file"}),name:n._({id:"JSON file"}),extensions:["json"]};return v(n,e,i,o,a,"json").then(t=>t.map(t=>{const r=new g.JsonResource,n=f.dirname(e.getProjectFile());return r.setFile(f.relative(n,t)),r.setName(f.relative(n,t)),r}))}}render(){return null}},s)}];const v=(e,t,r,n,o,a)=>{if(!h)return Promise.reject("Not supported");const i=["openFile"];r.multiSelections&&i.push("multiSelections");const s=f.dirname(t.getProjectFile()),c=n(t,a)||s,u=m.remote.getCurrentWindow();return h.showOpenDialog(u,{title:r.title,properties:i,filters:[{name:r.name,extensions:r.extensions}],defaultPath:c}).then(({filePaths:r})=>{if(!r||!r.length)return[];const n=f.parse(r[0]).dir;o(t,a,n);if(r.filter(e=>!Object(l.g)(t,e)).length){if(d.b.showConfirmDialog(e._({id:"This/these file(s) are outside the project folder. Would you like to make a copy of them in your project folder first (recommended)?"})))return Object(l.c)(t,r)}return r})}}).call(this,r(1))},1947:function(e,t,r){"use strict";var n=r(1948),o=r(1949),a=r(1950),i=r(11);const s=[{name:"piskel-app",displayName:"Edit with Piskel",kind:"image",edit:e=>(Object(i.g)("piskel"),Object(n.a)(e))},{name:"Jfxr",displayName:"Create/Edit a Sound effect with Jfxr (*.wav)",kind:"audio",edit:e=>(Object(i.g)("jfxr"),Object(o.a)(e))},{name:"Yarn",displayName:"Create/Edit a Dialogue Tree with Yarn (*.json)",kind:"json",edit:e=>(Object(i.g)("yarn"),Object(a.a)(e))}];t.a=s},1948:function(e,t,r){"use strict";(function(e){r.d(t,"a",(function(){return p}));var n=r(77),o=r(6),a=r.n(o),i=r(216);const s=a()("electron"),c=a()("path"),l=s?s.ipcRenderer:null,u=e.gd,p=({project:e,resourcesLoader:t,resourceNames:r,singleFrame:o,onChangesSaved:a,extraOptions:p})=>{if(!s||!l)return;const d=r.map((t,r)=>({resourcePath:Object(i.e)(e,t),resourceName:t,originalIndex:r})),m=c.dirname(e.getProjectFile()),h=Object(n.a)(Object(n.a)({},p),{},{resources:d,singleFrame:o,projectPath:m});l.removeAllListeners("piskel-changes-saved"),l.on("piskel-changes-saved",(t,r,n,o)=>{const s=o.data?{pskl:o}:null,l=e.getResourcesManager();r.forEach(t=>{t.name=c.relative(m,t.path),Object(i.d)(e,new u.ImageResource,t.name)}),r[0].metadata=s,r[0].newAnimationName=n,o.singleFrame?(s&&l.getResource(c.relative(m,r[0].path)).setMetadata(JSON.stringify(s)),a(r)):a(r)}),l.send("piskel-open-then-load-animation",h)}}).call(this,r(1))},1949:function(e,t,r){"use strict";(function(e){r.d(t,"a",(function(){return u}));var n=r(6),o=r.n(n),a=r(216);const i=o()("electron"),s=o()("path"),c=i?i.ipcRenderer:null,l=e.gd,u=({project:e,resourcesLoader:t,resourceNames:r,onChangesSaved:n,extraOptions:o})=>{if(!i||!c)return;const u=s.dirname(e.getProjectFile()),p={resourcePath:Object(a.e)(e,r[0]),externalEditorData:o.externalEditorData,projectPath:u};c.removeAllListeners("jfxr-changes-saved"),c.on("jfxr-changes-saved",(t,r,o)=>{const i=s.relative(u,r);Object(a.d)(e,new l.AudioResource,i);const c={jfxr:o};e.getResourcesManager().getResource(i).setMetadata(JSON.stringify(c)),n([{metadata:c,name:i}])}),c.send("jfxr-create-wav",p)}}).call(this,r(1))},1950:function(e,t,r){"use strict";(function(e){r.d(t,"a",(function(){return u}));var n=r(6),o=r.n(n),a=r(216);const i=o()("electron"),s=o()("path"),c=i?i.ipcRenderer:null,l=e.gd,u=({project:e,resourcesLoader:t,resourceNames:r,onChangesSaved:n,extraOptions:o})=>{if(!i||!c)return;const u=s.dirname(e.getProjectFile()),p={resourcePath:Object(a.e)(e,r[0]),externalEditorData:o.externalEditorData,projectPath:u};c.removeAllListeners("yarn-changes-saved"),c.on("yarn-changes-saved",(t,r)=>{const o=s.relative(u,r);Object(a.d)(e,new l.JsonResource,o),n([{name:o}])}),c.send("yarn-create-json",p)}}).call(this,r(1))},1951:function(e,t,r){"use strict";(function(e){r.d(t,"a",(function(){return w}));var n=r(71),o=r(4),a=r(193),i=r(6),s=r.n(i),c=r(871),l=r(174),u=r(1952),p=r(123),d=r.n(p),m=r(477),h=r(1953);const f=s()("electron"),g=s()("path"),v=f?f.ipcRenderer:null,b=f?f.remote.BrowserWindow:null,E=e.gd;class w extends o.Component{constructor(...e){super(...e),this.canDoNetworkPreview=()=>!0,this.canDoHotReload=()=>!0,this.state={networkPreviewDialogOpen:!1,networkPreviewHost:null,networkPreviewPort:null,networkPreviewError:null,previewGamePath:null,devToolsOpen:!1,previewBrowserWindowConfig:null,hotReloadsCount:0,hideMenuBar:!0},this._networkPreviewSubscriptionChecker=null,this._hotReloadSubscriptionChecker=null,this._openPreviewBrowserWindow=()=>{if(!b||!this.state.previewBrowserWindowConfig||!this.state.previewGamePath)return;const e=new b(this.state.previewBrowserWindowConfig);e.loadURL("file://".concat(this.state.previewGamePath,"/index.html")),e.setMenuBarVisibility(this.state.hideMenuBar),e.webContents.on("devtools-opened",()=>{this.setState({devToolsOpen:!0})}),e.webContents.on("devtools-closed",()=>{this.setState({devToolsOpen:!1})}),this.state.devToolsOpen&&e.openDevTools()},this._openPreviewWindow=(e,t,r)=>{this.setState({previewBrowserWindowConfig:{width:e.getGameResolutionWidth(),height:e.getGameResolutionHeight(),useContentSize:!0,title:"Preview of ".concat(e.getName()),backgroundColor:"#000000",webPreferences:{nodeIntegration:!0}},previewGamePath:t,hideMenuBar:!r.getIsMenuBarHiddenInPreview()},()=>{if(r.networkPreview){if(!v)return;v.removeAllListeners("serve-folder-done"),v.removeAllListeners("local-network-ips"),v.on("serve-folder-done",(e,t,r)=>{t?this.setState({networkPreviewDialogOpen:!0,networkPreviewPort:null,networkPreviewHost:null,networkPreviewError:t}):this.setState({networkPreviewDialogOpen:!0,networkPreviewPort:r.port}),setTimeout(()=>this._checkSubscriptionForNetworkPreview())}),v.on("local-network-ip",(e,t)=>{this.setState({networkPreviewHost:t})}),v.send("serve-folder",{root:t}),v.send("get-local-network-ip")}else this._openPreviewBrowserWindow()})},this._prepareExporter=()=>Object(l.findGDJS)().then(({gdjsRoot:e})=>{console.info("GDJS found in ",e);const t=d()(new E.AbstractFileSystemJS,a.a);return{outputDir:g.join(t.getTempDir(),"preview"),exporter:new E.Exporter(t,e)}}),this.launchPreview=e=>{const t=e.project,r=e.layout,n=e.externalLayout;return this.getPreviewDebuggerServer().startServer().catch(e=>{console.error("Unable to start the Debugger Server for the preview:",e)}).then(()=>this._prepareExporter()).then(({outputDir:o,exporter:a})=>{Object(c.a)(()=>{const i=new E.PreviewExportOptions(t,o);i.setLayoutName(r.getName()),n&&i.setExternalLayoutName(n.getName());const s=this.getPreviewDebuggerServer().getServerAddress();s&&i.setDebuggerServerAddress(s.address,""+s.port);const c=this.props.getIncludeFileHashs();for(const e in c){const t=c[e];i.setIncludeFileHash(e,t)}const l=this.getPreviewDebuggerServer().getExistingDebuggerIds(),u=e.hotReload&&!!l.length;i.setProjectDataOnlyExport(u&&e.projectDataOnlyExport),a.exportProjectForPixiPreview(i),i.delete(),a.delete(),u?(l.forEach(e=>{this.getPreviewDebuggerServer().sendMessage(e,{command:"hotReload"})}),this.state.hotReloadsCount%16===0&&this._hotReloadSubscriptionChecker&&this._hotReloadSubscriptionChecker.checkHasSubscription(),this.setState(e=>({hotReloadsCount:e.hotReloadsCount+1}))):this._openPreviewWindow(t,o,e)},e=>console.info("Preview took ".concat(e,"ms")))})},this._checkSubscriptionForNetworkPreview=()=>!this._networkPreviewSubscriptionChecker||this._networkPreviewSubscriptionChecker.checkHasSubscription()}getPreviewDebuggerServer(){return h.a}render(){const e=this.state,t=e.networkPreviewDialogOpen,r=e.networkPreviewHost,a=e.networkPreviewPort,i=e.networkPreviewError;return o.createElement(o.Fragment,null,o.createElement(m.a,{ref:e=>this._networkPreviewSubscriptionChecker=e,onChangeSubscription:()=>{this.setState({networkPreviewDialogOpen:!1}),this.props.onChangeSubscription&&this.props.onChangeSubscription()},id:"Preview over wifi",title:o.createElement(n.Trans,{id:"Preview over wifi"}),mode:"try"}),o.createElement(m.a,{ref:e=>this._hotReloadSubscriptionChecker=e,onChangeSubscription:()=>{this.props.onChangeSubscription&&this.props.onChangeSubscription()},id:"Hot reloading",title:o.createElement(n.Trans,{id:"Live preview (apply changes to the running preview)"}),mode:"try"}),o.createElement(u.a,{open:t,url:r&&a?"".concat(r,":").concat(a):null,error:i,onClose:()=>this.setState({networkPreviewDialogOpen:!1}),onExport:this.props.onExport,onRunPreviewLocally:this._openPreviewBrowserWindow}))}}}).call(this,r(1))},1952:function(e,t,r){"use strict";r.d(t,"a",(function(){return p}));var n=r(71),o=r(4),a=r(84),i=r(81),s=r(93),c=r(80),l=r(73),u=r(125);class p extends o.Component{render(){const e=this.props,t=e.url,r=e.open,p=e.error,d=e.onExport,m=e.onClose,h=e.onRunPreviewLocally;return r?o.createElement(a.a,{actions:[o.createElement(i.a,{key:"close",label:o.createElement(n.Trans,{id:"Close"}),primary:!0,onClick:m})],secondaryActions:[d&&o.createElement(i.a,{key:"export",label:o.createElement(n.Trans,{id:"Export game"}),onClick:d}),o.createElement(i.a,{key:"run-preview-locally",label:o.createElement(n.Trans,{id:"Run on this computer"}),onClick:h})],cannotBeDismissed:!0,open:r,onRequestClose:m},p&&o.createElement(l.b,null,o.createElement(c.a,null,o.createElement(n.Trans,{id:"Unable to start the server for the preview! Make sure that you are authorized to run servers on this computer. Otherwise, use classic preview to test your game."}))),!p&&!t&&o.createElement(u.a,null),!p&&t&&o.createElement("div",null,o.createElement(l.b,null,o.createElement(c.a,null,o.createElement(n.Trans,{id:"Your preview is ready! On your mobile or tablet, open your browser and enter in the address bar:"}))),o.createElement(s.b,{value:t,fullWidth:!0}),o.createElement(l.b,null,o.createElement(c.a,null,o.createElement(n.Trans,{id:"Please note that your device should be connected on the same network as this computer."}))))):null}}},1953:function(e,t,r){"use strict";r.d(t,"a",(function(){return u}));var n=r(6);const o=r.n(n)()("electron"),a=o?o.ipcRenderer:null;let i="stopped",s=null;const c=[],l=[],u={startServer:()=>{if(!a)return Promise.reject();if("started"===i)return Promise.resolve();const e=new Promise((e,t)=>{let r=!1;i="stopped",s=null,a&&(a.removeAllListeners("debugger-send-message-done"),a.removeAllListeners("debugger-error-received"),a.removeAllListeners("debugger-connection-closed"),a.removeAllListeners("debugger-connection-opened"),a.removeAllListeners("debugger-start-server-done"),a.removeAllListeners("debugger-message-received")),a.on("debugger-error-received",(e,n)=>{r||(t(n),r=!0),c.forEach(({onErrorReceived:e})=>e(n))}),a.on("debugger-connection-closed",(e,{id:t})=>{const r=l.indexOf(t);-1!==r&&l.splice(r,1),c.forEach(({onConnectionClosed:e})=>e({id:t,debuggerIds:l}))}),a.on("debugger-connection-opened",(e,{id:t})=>{l.push(t),c.forEach(({onConnectionOpened:e})=>e({id:t,debuggerIds:l}))}),a.on("debugger-start-server-done",(t,{address:n})=>{console.info("Local preview debugger started"),i="started",s=n,r||(e(),r=!0),c.forEach(({onServerStateChanged:e})=>e())}),a.on("debugger-message-received",(e,{id:t,message:r})=>{console.info("Processing message received for debugger");try{const e=JSON.parse(r);c.forEach(({onHandleParsedMessage:r})=>r({id:t,parsedMessage:e}))}catch(n){console.warn("Error while parsing message received from debugger client:",n)}}),a.send("debugger-start-server")}),t=new Promise((e,t)=>{setTimeout(()=>{t(new Error("Debugger server not started or errored after 5s - aborting."))},5e3)});return Promise.race([e,t])},sendMessage:(e,t)=>{a&&("stopped"!==i?a.send("debugger-send-message",{id:e,message:JSON.stringify(t)}):console.error("Cannot send message when debugger server is stopped."))},getServerState:()=>i,getServerAddress:()=>s,getExistingDebuggerIds:()=>l,registerCallbacks:e=>(c.push(e),()=>{const t=c.indexOf(e);-1!==t&&c.splice(t,1)})}},1954:function(e,t,r){"use strict";r.d(t,"a",(function(){return y}));var n=r(71),o=r(4),a=r(1955),i=r(1956),s=r(1957),c=r(1958),l=r(1959),u=r(1961),p=r(1962),d=r(1963),m=r(895),h=r.n(m),f=r(897),g=r.n(f),v=r(896),b=r.n(v),E=r(892),w=r(893),x=r(894);const y=()=>[{name:o.createElement(n.Trans,{id:"Android (& iOS coming soon)"}),renderIcon:e=>o.createElement(h.a,e),helpPage:"/publishing/android_and_ios",description:o.createElement(n.Trans,{id:"Package your game for Android directly from GDevelop. iOS support is coming soon!"}),key:"localonlinecordovaexport",exportPipeline:u.a},{name:o.createElement(n.Trans,{id:"Web (upload online)"}),renderIcon:e=>o.createElement(x.a,e),helpPage:"/publishing/web",description:o.createElement(n.Trans,{id:"Upload your game online directly from GDevelop and share the link to players. Play to your game using your browser on computers and mobile phones."}),key:"localonlinewebexport",exportPipeline:d.a},{name:o.createElement(n.Trans,{id:"Local folder"}),renderIcon:e=>o.createElement(b.a,e),helpPage:"/publishing/html5_game_in_a_local_folder",description:o.createElement(n.Trans,{id:"Build the game locally as a HTML5 game. You can then publish it on website like Kongregate, Game Jolt, itch.io, Poki..."}),key:"localexport",exportPipeline:s.a,advanced:!0},{name:o.createElement(n.Trans,{id:"Facebook Instant Games"}),renderIcon:e=>o.createElement(E.a,e),helpPage:"/publishing/publishing-to-facebook-instant-games",description:o.createElement(n.Trans,{id:"Package your game as a Facebook Instant Games that can be played on Facebook Messenger."}),key:"localfacebookinstantgames",exportPipeline:l.a,advanced:!0},{name:o.createElement(n.Trans,{id:"iOS & Android (manual)"}),renderIcon:e=>o.createElement(w.a,e),helpPage:"/publishing/android_and_ios_with_cordova",description:o.createElement(n.Trans,{id:"Build the game locally as a Cordova project, and export it manually to iOS or Android with Cordova developers tools."}),key:"localcordovaexport",exportPipeline:a.a,advanced:!0},{name:o.createElement(n.Trans,{id:"Windows/macOS/Linux"}),renderIcon:e=>o.createElement(g.a,e),helpPage:"/publishing/windows-macos-linux",description:o.createElement(n.Trans,{id:"Package your game as an app for Windows, macOS or Linux directly from GDevelop."}),key:"localonlineelectronexport",exportPipeline:p.a},{name:o.createElement(n.Trans,{id:"Windows/macOS/Linux (manual)"}),renderIcon:e=>o.createElement(g.a,e),helpPage:"/publishing/windows-macos-linux-with-electron",description:o.createElement(n.Trans,{id:"Build the game locally and export it manually to Windows, macOS or Linux with third-party developer tools."}),key:"localelectronexport",exportPipeline:i.a,advanced:!0},{name:o.createElement(n.Trans,{id:"Cocos2d-JS"}),renderIcon:e=>o.createElement(h.a,e),helpPage:"/publishing/android_and_ios_with_cocos2d-js",description:o.createElement(n.Trans,{id:"Export your game using Cocos2d-JS game engine. The game can be compiled for Android or iOS if you install Cocos2d-JS developer tools."}),key:"localcocos2dexport",exportPipeline:c.a,experimental:!0}]},1955:function(e,t,r){"use strict";(function(e){r.d(t,"a",(function(){return E}));var n=r(71),o=r(4),a=r.n(o),i=r(83),s=r(73),c=r(174),l=r(193),u=r(283),p=r(123),d=r.n(p),m=r(6),h=r.n(m),f=r(884);const g=h()("electron"),v=g?g.shell:null,b=e.gd,E={name:"local-cordova",packageNameWarningType:"mobile",getInitialExportState:e=>({outputDir:e.getLastCompilationDirectory()}),canLaunchBuild:e=>!!e.outputDir,renderHeader:({project:e,exportState:t,updateExportState:r})=>a.a.createElement(s.a,{noMargin:!0},a.a.createElement(s.b,null,a.a.createElement(s.a,{noMargin:!0},a.a.createElement(f.b,null))),a.a.createElement(s.b,null,a.a.createElement(u.a,{type:"export",value:t.outputDir,defaultPath:e.getLastCompilationDirectory(),onChange:t=>{r(()=>({outputDir:t})),e.setLastCompilationDirectory(t)},fullWidth:!0}))),renderLaunchButtonLabel:()=>a.a.createElement(n.Trans,{id:"Package"}),prepareExporter:e=>Object(c.findGDJS)().then(({gdjsRoot:e})=>{console.info("GDJS found in ",e);const t=d()(new b.AbstractFileSystemJS,l.a);return{exporter:new b.Exporter(t,e)}}),launchExport:(e,{exporter:t})=>{const r=new b.MapStringBoolean;return r.set("exportForCordova",!0),t.exportWholePixiProject(e.project,e.exportState.outputDir,r),r.delete(),t.delete(),Promise.resolve(null)},launchResourcesDownload:(e,t)=>Promise.resolve(null),launchCompression:(e,t)=>Promise.resolve(null),renderDoneFooter:({exportState:e,onClose:t})=>{const r=()=>{v&&v.openItem(e.outputDir)};return a.a.createElement(f.a,{renderGameButton:()=>a.a.createElement(i.a,{key:"open",label:a.a.createElement(n.Trans,{id:"Open folder"}),primary:!0,onClick:r})})}}}).call(this,r(1))},1956:function(e,t,r){"use strict";(function(e){r.d(t,"a",(function(){return E}));var n=r(71),o=r(4),a=r.n(o),i=r(83),s=r(73),c=r(174),l=r(193),u=r(283),p=r(123),d=r.n(p),m=r(6),h=r.n(m),f=r(885);const g=h()("electron"),v=g?g.shell:null,b=e.gd,E={name:"local-electron",packageNameWarningType:"desktop",getInitialExportState:e=>({outputDir:e.getLastCompilationDirectory()}),canLaunchBuild:e=>!!e.outputDir,renderHeader:({project:e,exportState:t,updateExportState:r})=>a.a.createElement(s.a,{noMargin:!0},a.a.createElement(s.b,null,a.a.createElement(s.a,{noMargin:!0},a.a.createElement(f.b,null))),a.a.createElement(s.b,null,a.a.createElement(u.a,{type:"export",value:t.outputDir,defaultPath:e.getLastCompilationDirectory(),onChange:t=>{r(()=>({outputDir:t})),e.setLastCompilationDirectory(t)},fullWidth:!0}))),renderLaunchButtonLabel:()=>a.a.createElement(n.Trans,{id:"Package"}),prepareExporter:e=>Object(c.findGDJS)().then(({gdjsRoot:e})=>{console.info("GDJS found in ",e);const t=d()(new b.AbstractFileSystemJS,l.a);return{exporter:new b.Exporter(t,e)}}),launchExport:(e,{exporter:t})=>{const r=new b.MapStringBoolean;return r.set("exportForElectron",!0),t.exportWholePixiProject(e.project,e.exportState.outputDir,r),r.delete(),t.delete(),Promise.resolve(null)},launchResourcesDownload:(e,t)=>Promise.resolve(null),launchCompression:(e,t)=>Promise.resolve(null),renderDoneFooter:({exportState:e,onClose:t})=>{const r=()=>{v&&v.openItem(e.outputDir)};return a.a.createElement(f.a,{renderGameButton:()=>a.a.createElement(i.a,{key:"open",label:a.a.createElement(n.Trans,{id:"Open folder"}),primary:!0,onClick:r})})}}}).call(this,r(1))},1957:function(e,t,r){"use strict";(function(e){r.d(t,"a",(function(){return E}));var n=r(71),o=r(4),a=r.n(o),i=r(83),s=r(73),c=r(174),l=r(193),u=r(283),p=r(123),d=r.n(p),m=r(6),h=r.n(m),f=r(886);const g=h()("electron"),v=g?g.shell:null,b=e.gd,E={name:"local-html5",getInitialExportState:e=>({outputDir:e.getLastCompilationDirectory()}),canLaunchBuild:e=>!!e.outputDir,renderHeader:({project:e,exportState:t,updateExportState:r})=>a.a.createElement(s.a,{noMargin:!0},a.a.createElement(s.b,null,a.a.createElement(f.b,null)),a.a.createElement(s.b,null,a.a.createElement(u.a,{type:"export",value:t.outputDir,defaultPath:e.getLastCompilationDirectory(),onChange:t=>{r(()=>({outputDir:t})),e.setLastCompilationDirectory(t)},fullWidth:!0}))),renderLaunchButtonLabel:()=>a.a.createElement(n.Trans,{id:"Export as a HTML5 game"}),prepareExporter:e=>Object(c.findGDJS)().then(({gdjsRoot:e})=>{console.info("GDJS found in ",e);const t=d()(new b.AbstractFileSystemJS,l.a);return{exporter:new b.Exporter(t,e)}}),launchExport:(e,{exporter:t})=>{const r=new b.MapStringBoolean;return t.exportWholePixiProject(e.project,e.exportState.outputDir,r),r.delete(),t.delete(),Promise.resolve(null)},launchResourcesDownload:(e,t)=>Promise.resolve(null),launchCompression:(e,t)=>Promise.resolve(null),renderDoneFooter:({exportState:e,onClose:t})=>a.a.createElement(f.a,{renderGameButton:()=>a.a.createElement(i.a,{fullWidth:!0,primary:!0,onClick:()=>{v&&v.openItem(e.outputDir)},label:a.a.createElement(n.Trans,{id:"Open the exported game folder"})})})}}).call(this,r(1))},1958:function(e,t,r){"use strict";(function(e){r.d(t,"a",(function(){return x}));var n=r(77),o=r(71),a=r(4),i=r.n(a),s=r(83),c=r(73),l=r(174),u=r(193),p=r(283),d=r(123),m=r.n(d),h=r(6),f=r.n(h),g=r(304),v=r(887);const b=f()("electron"),E=b?b.shell:null,w=e.gd,x={name:"local-cocos2d",getInitialExportState:e=>({outputDir:e.getLastCompilationDirectory(),debugMode:!1}),canLaunchBuild:e=>!!e.outputDir,renderHeader:({project:e,exportState:t,updateExportState:r})=>i.a.createElement(c.a,{noMargin:!0},i.a.createElement(c.b,null,i.a.createElement(v.b,null)),i.a.createElement(c.b,null,i.a.createElement(p.a,{type:"export",value:t.outputDir,defaultPath:e.getLastCompilationDirectory(),onChange:e=>{r(t=>Object(n.a)(Object(n.a)({},t),{},{outputDir:e}))},fullWidth:!0})),i.a.createElement(c.b,null,i.a.createElement(g.a,{onToggle:(e,t)=>r(e=>Object(n.a)(Object(n.a)({},e),{},{debugMode:t})),toggled:t.debugMode,labelPosition:"right",label:i.a.createElement(o.Trans,{id:"Debug mode (show FPS counter and stats in the bottom left)"})}))),renderLaunchButtonLabel:()=>i.a.createElement(o.Trans,{id:"Package"}),prepareExporter:e=>Object(l.findGDJS)().then(({gdjsRoot:e})=>{console.info("GDJS found in ",e);const t=m()(new w.AbstractFileSystemJS,u.a);return{exporter:new w.Exporter(t,e)}}),launchExport:(e,{exporter:t})=>(t.exportWholeCocos2dProject(e.project,e.exportState.debugMode,e.exportState.outputDir),t.delete(),Promise.resolve(null)),launchResourcesDownload:(e,t)=>Promise.resolve(null),launchCompression:(e,t)=>Promise.resolve(null),renderDoneFooter:({exportState:e,onClose:t})=>{const r=()=>{E&&E.openItem(e.outputDir)};return i.a.createElement(v.a,{renderGameButton:()=>i.a.createElement(s.a,{key:"open",label:i.a.createElement(o.Trans,{id:"Open folder"}),primary:!0,onClick:r})})}}}).call(this,r(1))},1959:function(e,t,r){"use strict";(function(e){r.d(t,"a",(function(){return y}));var n=r(71),o=r(4),a=r.n(o),i=r(83),s=r(73),c=r(174),l=r(193),u=r(123),p=r.n(u),d=r(6),m=r.n(d),h=r(1960),f=r(427),g=r(888);const v=m()("path"),b=m()("electron"),E=b?b.remote.app:null,w=b?b.shell:null,x=e.gd,y={name:"local-facebook-instant-games",getInitialExportState:e=>({archiveOutputFilename:E?v.join(E.getPath("documents"),"fb-instant-game.zip"):""}),canLaunchBuild:e=>!!e.archiveOutputFilename,renderHeader:({project:e,exportState:t,updateExportState:r})=>a.a.createElement(s.a,{noMargin:!0},a.a.createElement(s.b,null,a.a.createElement(g.b,null)),a.a.createElement(s.b,null,a.a.createElement(h.a,{title:"Facebook Instant Games export zip file",message:"Choose where to save the exported file for Facebook Instant Games",filters:[{name:"Compressed file for Facebook Instant Games",extensions:["zip"]}],value:t.archiveOutputFilename,defaultPath:E?E.getPath("documents"):"",onChange:e=>r(()=>({archiveOutputFilename:e})),fullWidth:!0}))),renderLaunchButtonLabel:()=>a.a.createElement(n.Trans,{id:"Package"}),prepareExporter:e=>Object(c.findGDJS)().then(({gdjsRoot:e})=>{console.info("GDJS found in ",e);const t=p()(new x.AbstractFileSystemJS,l.a),r=new x.Exporter(t,e),n=v.join(t.getTempDir(),"FacebookInstantGamesExport");return t.mkDir(n),t.clearDir(n),{exporter:r,temporaryOutputDir:n}}),launchExport:(e,{exporter:t,temporaryOutputDir:r})=>{const n=new x.MapStringBoolean;return n.set("exportForFacebookInstantGames",!0),t.exportWholePixiProject(e.project,r,n),n.delete(),t.delete(),Promise.resolve({temporaryOutputDir:r})},launchResourcesDownload:(e,{temporaryOutputDir:t})=>Promise.resolve({temporaryOutputDir:t}),launchCompression:(e,{temporaryOutputDir:t})=>Object(f.a)({path:t,outputFilename:e.exportState.archiveOutputFilename}),renderDoneFooter:({exportState:e,onClose:t})=>{const r=()=>{w&&v&&w.openItem(v.dirname(e.archiveOutputFilename))};return a.a.createElement(g.a,{renderGameButton:()=>a.a.createElement(i.a,{key:"open",label:a.a.createElement(n.Trans,{id:"Open folder"}),primary:!0,onClick:r})})}}}).call(this,r(1))},1960:function(e,t,r){"use strict";r.d(t,"a",(function(){return h}));var n=r(77),o=r(71),a=r(4),i=r.n(a),s=r(93),c=r(6),l=r.n(c),u=r(83);const p=l()("electron"),d=p?p.remote.dialog:null,m={container:{position:"relative",display:"flex",alignItems:"baseline"},button:{marginLeft:10},textField:{flex:1}};class h extends a.PureComponent{constructor(...e){super(...e),this.onChooseFolder=()=>{if(!d||!p)return;const e=p.remote.getCurrentWindow();return d.showSaveDialog(e,{title:this.props.title,filters:this.props.filters,message:this.props.message,defaultPath:this.props.defaultPath}).then(({filePath:e})=>{this.props.onChange(e||"")})}}render(){return i.a.createElement("div",{style:Object(n.a)(Object(n.a)({},m.container),{},{width:this.props.fullWidth?"100%":void 0})},i.a.createElement(s.b,{margin:"dense",style:m.textField,type:"text",hintText:{id:"Choose a file"},value:this.props.value,onChange:(e,t)=>this.props.onChange(t)}),i.a.createElement(u.a,{label:i.a.createElement(o.Trans,{id:"Choose"}),style:m.button,onClick:this.onChooseFolder}))}}},1961:function(e,t,r){"use strict";(function(e){r.d(t,"a",(function(){return b}));var n=r(71),o=r(4),a=r(123),i=r.n(a),s=r(207),c=r(574),l=r(174),u=r(427),p=r(6),d=r.n(p),m=r(193),h=r(889);const f=d()("path"),g=d()("os"),v=e.gd,b={name:"local-online-cordova",onlineBuildType:"cordova-build",packageNameWarningType:"mobile",getInitialExportState:()=>null,canLaunchBuild:()=>!0,renderHeader:()=>o.createElement(h.a,null),renderLaunchButtonLabel:()=>o.createElement(n.Trans,{id:"Packaging for Android"}),prepareExporter:e=>Object(l.findGDJS)().then(({gdjsRoot:e})=>{console.info("GDJS found in ",e);const t=i()(new v.AbstractFileSystemJS,m.a),r=new v.Exporter(t,e),n=f.join(t.getTempDir(),"OnlineCordovaExport");return t.mkDir(n),t.clearDir(n),{exporter:r,temporaryOutputDir:n}}),launchExport:(e,{exporter:t,temporaryOutputDir:r})=>{const n=new v.MapStringBoolean;return n.set("exportForCordova",!0),t.exportWholePixiProject(e.project,r,n),n.delete(),t.delete(),Promise.resolve({temporaryOutputDir:r})},launchResourcesDownload:(e,{temporaryOutputDir:t})=>Promise.resolve({temporaryOutputDir:t}),launchCompression:(e,{temporaryOutputDir:t})=>{const r=g.tmpdir();return Object(u.a)({path:t,outputFilename:f.join(r,"game-archive.zip")})},launchUpload:(e,t)=>Object(s.f)().then(r=>Object(c.a)(t,r,e.updateStepProgress).then(()=>r.key)),launchOnlineBuild:(e,t,r)=>{const n=t.getAuthorizationHeader,o=t.profile;return o?Object(s.a)(n,o.uid,r):Promise.reject(new Error("User is not authenticated"))}}}).call(this,r(1))},1962:function(e,t,r){"use strict";(function(e){r.d(t,"a",(function(){return b}));var n=r(71),o=r(4),a=r(123),i=r.n(a),s=r(207),c=r(174),l=r(574),u=r(427),p=r(6),d=r.n(p),m=r(193),h=r(890);const f=d()("path"),g=d()("os"),v=e.gd,b={name:"local-online-electron",onlineBuildType:"electron-build",packageNameWarningType:"desktop",getInitialExportState:()=>({targets:["winExe"]}),canLaunchBuild:e=>!!e.targets.length,renderHeader:e=>o.createElement(h.a,e),renderLaunchButtonLabel:()=>o.createElement(n.Trans,{id:"Package"}),prepareExporter:e=>Object(c.findGDJS)().then(({gdjsRoot:e})=>{console.info("GDJS found in ",e);const t=i()(new v.AbstractFileSystemJS,m.a),r=new v.Exporter(t,e),n=f.join(t.getTempDir(),"OnlineElectronExport");return t.mkDir(n),t.clearDir(n),{exporter:r,temporaryOutputDir:n}}),launchExport:(e,{exporter:t,temporaryOutputDir:r})=>{const n=new v.MapStringBoolean;return n.set("exportForElectron",!0),t.exportWholePixiProject(e.project,r,n),n.delete(),t.delete(),Promise.resolve({temporaryOutputDir:r})},launchResourcesDownload:(e,{temporaryOutputDir:t})=>Promise.resolve({temporaryOutputDir:t}),launchCompression:(e,{temporaryOutputDir:t})=>{const r=g.tmpdir();return Object(u.a)({path:t,outputFilename:f.join(r,"game-archive.zip")})},launchUpload:(e,t)=>Object(s.f)().then(r=>Object(l.a)(t,r,e.updateStepProgress).then(()=>r.key)),launchOnlineBuild:(e,t,r)=>{const n=t.getAuthorizationHeader,o=t.profile;return o?Object(s.b)(n,o.uid,r,e.targets):Promise.reject(new Error("User is not authenticated"))}}}).call(this,r(1))},1963:function(e,t,r){"use strict";(function(e){r.d(t,"a",(function(){return b}));var n=r(71),o=r(4),a=r(123),i=r.n(a),s=r(207),c=r(574),l=r(174),u=r(427),p=r(6),d=r.n(p),m=r(193),h=r(891);const f=d()("path"),g=d()("os"),v=e.gd,b={name:"local-online-web",onlineBuildType:"web-build",getInitialExportState:()=>null,canLaunchBuild:()=>!0,renderHeader:()=>o.createElement(h.a,null),renderLaunchButtonLabel:()=>o.createElement(n.Trans,{id:"Publish online"}),prepareExporter:e=>Object(l.findGDJS)().then(({gdjsRoot:e})=>{console.info("GDJS found in ",e);const t=i()(new v.AbstractFileSystemJS,m.a),r=new v.Exporter(t,e),n=f.join(t.getTempDir(),"OnlineWebExport");return t.mkDir(n),t.clearDir(n),{exporter:r,temporaryOutputDir:n}}),launchExport:(e,{exporter:t,temporaryOutputDir:r})=>{const n=new v.MapStringBoolean;return t.exportWholePixiProject(e.project,r,n),n.delete(),t.delete(),Promise.resolve({temporaryOutputDir:r})},launchResourcesDownload:(e,{temporaryOutputDir:t})=>Promise.resolve({temporaryOutputDir:t}),launchCompression:(e,{temporaryOutputDir:t})=>{const r=g.tmpdir();return Object(u.a)({path:t,outputFilename:f.join(r,"game-archive.zip")})},launchUpload:(e,t)=>Object(s.f)().then(r=>Object(c.a)(t,r,e.updateStepProgress).then(()=>r.key)),launchOnlineBuild:(e,t,r)=>{const n=t.getAuthorizationHeader,o=t.profile;return o?Object(s.c)(n,o.uid,r):Promise.reject(new Error("User is not authenticated"))}}}).call(this,r(1))},1964:function(e,t,r){"use strict";var n=r(4),o=r(6),a=r.n(o),i=r(205),s=r(247),c=r(25);const l=a()("electron"),u=l?l.ipcRenderer:null,p=(e,t)=>{n.useEffect(()=>{if(!u)return;const r=(e,...r)=>t(...r);return u.on(e,r),()=>u.removeListener(e,r)},[e,t])};t.a=e=>{const t=e.i18n,r=e.project,o=e.recentProjectFiles,a=e.onOpenRecentFile,l=Object(s.e)(),d=t.language;return p("main-menu-open",e.onChooseProject),p("main-menu-open-recent",e.onOpenRecentFile),p("main-menu-save",e.onSaveProject),p("main-menu-save-as",e.onSaveProjectAs),p("main-menu-close",e.onCloseProject),p("main-menu-close-app",e.onCloseApp),p("main-menu-export",e.onExportProject),p("main-menu-create",e.onCreateProject),p("main-menu-open-project-manager",e.onOpenProjectManager),p("main-menu-open-start-page",e.onOpenStartPage),p("main-menu-open-debugger",e.onOpenDebugger),p("main-menu-open-about",e.onOpenAbout),p("main-menu-open-preferences",e.onOpenPreferences),p("main-menu-open-language",e.onOpenLanguage),p("main-menu-open-profile",e.onOpenProfile),p("main-menu-open-games-dashboard",e.onOpenGamesDashboard),p("update-status",e.setUpdateStatus),n.useEffect(()=>{((e,t,r,n)=>{const o={label:t._({id:"File"}),submenu:[{label:t._({id:"Create a New Project..."}),accelerator:Object(s.a)(n.CREATE_NEW_PROJECT),onClickSendEvent:"main-menu-create"},{type:"separator"},{label:t._({id:"Open..."}),accelerator:Object(s.a)(n.OPEN_PROJECT),onClickSendEvent:"main-menu-open"},{label:t._({id:"Open Recent"}),submenu:r.map(e=>({label:e.fileMetadata.fileIdentifier,onClickSendEvent:"main-menu-open-recent",eventArgs:e}))},{type:"separator"},{label:t._({id:"Save"}),accelerator:Object(s.a)(n.SAVE_PROJECT),onClickSendEvent:"main-menu-save",enabled:!!e},{label:t._({id:"Save as..."}),accelerator:Object(s.a)(n.SAVE_PROJECT_AS),onClickSendEvent:"main-menu-save-as",enabled:!!e},{type:"separator"},{label:t._({id:"Export (web, iOS, Android)..."}),accelerator:Object(s.a)(n.EXPORT_GAME),onClickSendEvent:"main-menu-export",enabled:!!e},{type:"separator"},{label:t._({id:"Close Project"}),accelerator:Object(s.a)(n.CLOSE_PROJECT),onClickSendEvent:"main-menu-close",enabled:!!e}]};Object(c.e)()||o.submenu.push({type:"separator"},{label:t._({id:"My Profile"}),onClickSendEvent:"main-menu-open-profile"},{label:t._({id:"Games Dashboard"}),onClickSendEvent:"main-menu-open-games-dashboard"},{label:t._({id:"Preferences"}),onClickSendEvent:"main-menu-open-preferences"},{label:t._({id:"Language"}),onClickSendEvent:"main-menu-open-language"},{type:"separator"},{label:t._({id:"Exit GDevelop"}),accelerator:Object(s.a)(n.QUIT_APP),onClickSendEvent:"main-menu-close-app"});const a={label:t._({id:"Edit"}),submenu:[{role:"undo"},{role:"redo"},{type:"separator"},{role:"cut"},{role:"copy"},{role:"paste"},{role:"pasteandmatchstyle"},{role:"delete"},{role:"selectall"}]},i={label:t._({id:"View"}),submenu:[{label:t._({id:"Show Project Manager"}),accelerator:Object(s.a)(n.OPEN_PROJECT_MANAGER),onClickSendEvent:"main-menu-open-project-manager",enabled:!!e},{label:t._({id:"Show Start Page"}),onClickSendEvent:"main-menu-open-start-page"},{label:t._({id:"Open Debugger"}),onClickSendEvent:"main-menu-open-debugger",enabled:!!e},{type:"separator"},{role:"toggledevtools"},{type:"separator"},{role:"togglefullscreen"}]},l={label:t._({id:"Window"}),role:"window",submenu:[{label:t._({id:"Minimize"}),role:"minimize"}]},p={label:t._({id:"Help"}),role:"help",submenu:[{label:t._({id:"GDevelop website"}),onClickOpenLink:"http://gdevelop-app.com"},{type:"separator"},{label:t._({id:"Community Forums"}),onClickOpenLink:"https://forum.gdevelop-app.com"},{label:t._({id:"Community Discord Chat"}),onClickOpenLink:"https://discord.gg/rjdYHvj"},{type:"separator"},{label:t._({id:"Contribute to GDevelop"}),onClickOpenLink:"https://gdevelop-app.com/contribute/"},{label:t._({id:"Create Extensions for GDevelop"}),onClickOpenLink:"https://github.com/4ian/GDevelop/blob/master/newIDE/README-extensions.md"},{type:"separator"},{label:t._({id:"Help to Translate GDevelop"}),onClickOpenLink:"https://crowdin.com/project/gdevelop"},{label:t._({id:"Report a wrong translation"}),onClickOpenLink:"https://github.com/4ian/GDevelop/issues/969"}]};Object(c.e)()||p.submenu.push({type:"separator"},{label:t._({id:"About GDevelop"}),onClickSendEvent:"main-menu-open-about"});const d=[o,a,i,l,p];Object(c.e)()&&(d.unshift({label:t._({id:"GDevelop 5"}),submenu:[{label:t._({id:"About GDevelop"}),onClickSendEvent:"main-menu-open-about"},{type:"separator"},{label:t._({id:"My Profile"}),onClickSendEvent:"main-menu-open-profile"},{label:t._({id:"Games Dashboard"}),onClickSendEvent:"main-menu-open-games-dashboard"},{label:t._({id:"Preferences"}),onClickSendEvent:"main-menu-open-preferences"},{label:t._({id:"Language"}),onClickSendEvent:"main-menu-open-language"},{type:"separator"},{role:"services",submenu:[]},{type:"separator"},{role:"hide"},{role:"hideothers"},{role:"unhide"},{type:"separator"},{role:"quit"}]}),a.submenu.push({type:"separator"},{label:t._({id:"Speech"}),submenu:[{role:"startspeaking"},{role:"stopspeaking"}]}),l.submenu=[{role:"minimize"},{role:"zoom"},{type:"separator"},{role:"front"}]),u&&u.send("set-main-menu",d)})(r,t,o,l)},[t,d,r,o,l]),Object(i.b)("OPEN_RECENT_PROJECT",!0,{generateOptions:n.useCallback(()=>o.map(e=>({text:e.fileMetadata.fileIdentifier,handler:()=>a(e)})),[a,o])}),null}},1965:function(e,t,r){const n=r(898).loadExtension,o=r(6),a=r(1966).findJsExtensionModules;e.exports=function({gd:e,objectsEditorService:t,objectsRenderingService:r,filterExamples:i}){return{loadAllExtensions:s=>a({filterExamples:i}).then(a=>Promise.all(a.map(a=>{let i=null;try{i=o(a,{rethrowException:!0})}catch(c){return{extensionModulePath:a,result:{message:"Unable to import extension. Please check for any syntax error or error that would prevent it from being run.",error:!0,rawError:c}}}return i?(t&&i.registerEditorConfigurations&&i.registerEditorConfigurations(t),r&&i.registerInstanceRenderers&&i.registerInstanceRenderers(r),{extensionModulePath:a,result:n(s,e,e.JsPlatform.get(),i)}):{extensionModulePath:a,result:{error:!0,message:"Unknown error. Please check for any syntax error or error that would prevent it from being run."}}})),e=>{throw console.error("Unable to find JS extensions modules"),e})}}},1966:function(e,t,r){const n=r(174).findGDJS,o=r(6),a=o("path"),i=o("fs");e.exports={findJsExtensionModules:({filterExamples:e})=>n().then(({gdjsRoot:t})=>{const r=a.join(t,"Runtime","Extensions");return console.info("Searching for JS extensions (file called JsExtension.js) in ".concat(r,"...")),new Promise((t,n)=>{i.readdir(r,(o,s)=>{if(o)return n(o);const c=s.filter(t=>!e||-1===t.indexOf("Example"));Promise.all(c.map(e=>{return t=a.join(r,e),new Promise(e=>{const r=a.join(t,"JsExtension.js");i.stat(r,(t,n)=>e(t?null:n.isFile()?r:null))});var t})).then(e=>{t(e.filter(e=>!!e))},n)})})})}},1967:function(e,t,r){"use strict";r.d(t,"a",(function(){return l}));var n=r(6),o=r.n(n),a=r(399),i=r.n(a);const s=o()("os"),c=o()("fs"),l=({onWriteFile:e})=>{const t=s.tmpdir()+"/GDGeneratedEventsFunctions";c.mkdir(t,e=>{e&&"EEXIST"!==e.code&&console.error("Unable to create the directory where to output events functions generated code: ",e)});const r=e=>"".concat(t,"/").concat(i()(e),".js");return{getIncludeFileFor:e=>r(e),writeFunctionCode:(t,n)=>new Promise((o,a)=>{const i=r(t);e({includeFile:i,content:n}),c.writeFile(i,n,e=>{if(e)return a(e);o()})}),writeBehaviorCode:(t,n)=>new Promise((o,a)=>{const i=r(t);e({includeFile:i,content:n}),c.writeFile(i,n,e=>{if(e)return a(e);o()})})}}},1979:function(e,t,r){"use strict";r.d(t,"a",(function(){return u}));var n=r(129),o=r(6),a=r.n(o);const i=a()("fs-extra"),s=a()("path"),c=a()("electron"),l=c?c.remote.dialog:null;class u{}u.chooseEventsFunctionExtensionFile=()=>{if(!l)return Promise.reject("Not supported");const e=c.remote.getCurrentWindow();return l.showSaveDialog(e,{title:"Export an extension of the project",filters:[{name:'GDevelop 5 "events based" extension',extensions:["json"]}],defaultPath:"Extension.json"}).then(({filePath:e})=>e||null)},u.writeEventsFunctionsExtension=(e,t)=>((e,t)=>{if(!i)return Promise.reject(new Error("Filesystem is not supported."));try{const r=JSON.stringify(e,null,2);return i.ensureDir(s.dirname(t)).then(()=>new Promise((e,n)=>{i.writeFile(t,r,t=>t?n(t):e())}))}catch(r){return Promise.reject(r)}})(Object(n.b)(e),t).catch(e=>{throw console.error("Unable to write the events function extension:",e),e})},1980:function(e,t,r){"use strict";r.d(t,"a",(function(){return c}));var n=r(6),o=r.n(n);const a=o()("fs"),i=o()("electron"),s=i?i.remote.dialog:null;class c{}c.chooseEventsFunctionExtensionFile=()=>{if(!s)return Promise.reject("Not supported");const e=i.remote.getCurrentWindow();return s.showOpenDialog(e,{title:"Import an extension in the project",properties:["openFile"],message:"Choose an extension file to import (.json file)",filters:[{name:'GDevelop 5 "events based" extension',extensions:["json"]}]}).then(({filePaths:e})=>e&&e.length?e[0]:null)},c.readEventsFunctionExtensionFile=e=>(e=>a?new Promise((t,r)=>{a.readFile(e,{encoding:"utf8"},(n,o)=>{if(n)return r(n);try{const e=JSON.parse(o);return t(e)}catch(a){return r(e+" is a corrupted/malformed file.")}})}):Promise.reject("Filesystem is not supported."))(e)},1981:function(e,t,r){"use strict";r.d(t,"a",(function(){return b}));var n=r(4),o=r(6),a=r.n(o),i=r(113),s=r(276),c=r.n(s);const l=a()("electron"),u=a()("fs"),p=a()("child_process"),d=a()("process"),m=a()("path"),h=()=>{if(!l)return"";const e=d.cwd();return m.join(e,"../app")},f=()=>{if(!l||!u)return Promise.resolve({paths:[],pathsWithErrors:{}});const e={},t=m.join(h(),"../.."),r=m.join(t,"GDJS/Runtime"),n=m.join(t,"Extensions");return new Promise(t=>u.readdir(n,(r,o)=>{if(r)return e[n]=r,void t([]);t(Promise.all(o.map(t=>new Promise(r=>{const o=m.join(n,t);u.stat(o,(t,n)=>{if(t)return e[o]=t,void r(o);r(n.isDirectory()?o:null)})}))).then(e=>e.filter(Boolean)))})).then(t=>Promise.resolve([r].concat(["Cocos2d","Cordova","Electron","FacebookInstantGames","cocos-renderers","cocos-sound-manager","events-tools","fontfaceobserver-font-manager","howler-sound-manager","libs","pixi-renderers","websocket-debugger-client"].map(e=>m.join(r,e)))).then(r=>({paths:[...r,...t],pathsWithErrors:e})))},g=()=>p&&m?new Promise((e,t)=>{const r=performance.now();p.exec('node "'.concat(m.join(h(),"scripts/import-GDJS-Runtime.js"),'"'),(n,o,a)=>{if(n)return console.error("GDJS Runtime update error:\n".concat(n)),void t(n);const i=(performance.now()-r).toFixed(0);if(console.info("GDJS Runtime updated in ".concat(i,"ms:\n").concat(o)),a)return console.error("GDJS Runtime update error:\n".concat(a)),void t(new Error("Error while updating GDJS Runtime"));e()})}):Promise.reject(new Error("Unsupported")),v=c()((e,t)=>{const r=e||"unknown-event",n=t||"unknown-file";console.info('GDJS/extensions watchers found a "'.concat(r,'" in ').concat(n,", updating GDJS Runtime...")),g().catch(()=>{})},100),b=()=>{const e=n.useContext(i.b).values.useGDJSDevelopmentWatcher;return n.useEffect(()=>{if(!e)return;let t=!1,r=[],n=performance.now();return f().then(({paths:e,pathsWithErrors:o})=>{if(t)return;if(!u)return void console.error("Unable to use 'fs' from Node.js to watch changes in GDJS.");g().catch(()=>{}),e.forEach(e=>{let t=null;try{t=u.watch(e,{},v)}catch(n){return o[e]=n,null}t&&(t.on("error",e=>{console.warn("Error in watcher for GDJS Runtime - manually call npm run `node import-GDJS-Runtime.js` in the newIDE/app/scripts folder if you make changes to GDJS.",e)}),r.push(t))}),Object.keys(o).length&&console.warn("Error while setting up watchers for some paths: ",o);const a=(performance.now()-n).toFixed(2);r.length?console.info("Watchers for GDJS Runtime/extensions installed in ".concat(a,"ms.")):console.warn("No watchers for GDJS Runtime/extensions installed (took ".concat(a,"ms)."))}),()=>{t=!0,r.length&&(r.forEach(e=>{e.close()}),console.info("Watchers for GDJS Runtime closed."))}},[e]),null}},1982:function(e,t,r){"use strict";r.d(t,"a",(function(){return v}));var n=r(100),o=r.n(n),a=r(107),i=r(6),s=r.n(i),c=r(122),l=r(1983),u=r.n(l);const p=s()("electron"),d=p?p.ipcRenderer:null,m=s()("fs-extra"),h=s()("path"),f=e=>{const t=e.getResourcesManager();return t.getAllResourceNames().toJSArray().filter(e=>{const r=t.getResource(e);return(n=r.getFile()).startsWith("http://")||n.startsWith("https://")||n.startsWith("ftp://");var n})},g=function(){var e=Object(a.a)(o.a.mark((function e({project:t,resourceNames:r,onProgress:n}){var i,s,l,p,g,v,b,E;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(m&&d){e.next=2;break}throw new Error("Unsupported");case 2:return i=t.getResourcesManager(),s=h.dirname(t.getProjectFile()),l=h.join(s,"assets"),p=new Set,g=[],v=[],b=0,E=f(t),e.abrupt("return",u.a.withConcurrency(3).for(r).process(function(){var e=Object(a.a)(o.a.mark((function e(t){var r,a,u,f,w,x;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=i.getResource(t),a=r.getFile(),u=h.extname(a),f=h.basename(a,u),w=Object(c.a)(f,e=>{const t=h.join(l,e)+u;return m.existsSync(t)||p.has(t)}),x=h.join(l,w)+u,p.add(x),e.prev=7,e.next=10,m.ensureDir(l);case 10:return e.next=12,d.invoke("local-file-download",a,x);case 12:r.setFile(h.relative(s,x).replace(/\\/g,"/")),v.push({resourceName:t}),e.next=19;break;case 16:e.prev=16,e.t0=e.catch(7),g.push({resourceName:t,error:e.t0});case 19:n(b++,E.length);case 20:case"end":return e.stop()}}),e,null,[[7,16]])})));return function(t){return e.apply(this,arguments)}}()).then(()=>({fetchedResources:v,erroredResources:g})));case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),v={getResourcesToFetch:f,fetchResources:g}},1983:function(e,t,r){"use strict";const n=r(1984);e.exports=n.PromisePool},1984:function(e,t,r){"use strict";var n=r(100),o=r(428);Object.defineProperty(t,"__esModule",{value:!0}),t.PromisePool=void 0;const a=r(902),i=r(1987);t.PromisePool=class{constructor(){this.items=[],this.concurrency=10,this.errorHandler=void 0}withConcurrency(e){return a.tap(this,()=>{this.concurrency=e})}static withConcurrency(e){return a.tap(this,()=>{this.concurrency=e})}for(e){return a.tap(this,()=>{this.items=e})}static for(e){return(new this).for(e).withConcurrency(this.concurrency)}handleError(e){return a.tap(this,()=>{this.errorHandler=e})}process(e){var t=this;return o(n.mark((function r(){return n.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(new i.PromisePoolExecutor).withConcurrency(t.concurrency).withHandler(e).handleError(t.errorHandler).for(t.items).start());case 1:case"end":return r.stop()}}),r)})))()}}},1985:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ifNullish=t.isAsyncFunction=t.isPromise=t.upon=t.tap=void 0;const n=r(1986);t.tap=function(e,t){return(new n.Goodies).tap(e,t)},t.upon=function(e,t){return(new n.Goodies).upon(e,t)},t.isPromise=function(e){return(new n.Goodies).isPromise(e)},t.isAsyncFunction=function(e){return(new n.Goodies).isAsyncFunction(e)},t.ifNullish=function(e,t){return(new n.Goodies).ifNullish(e,t)}},1986:function(e,t,r){"use strict";var n=r(100),o=r(428);Object.defineProperty(t,"__esModule",{value:!0}),t.Goodies=void 0;t.Goodies=class{tap(e,t){return this.isPromise(e)||this.isAsyncFunction(t)?this.tapAsync(e,t):this.tapSync(e,t)}tapSync(e,t){return t?(this.isFunction(t)&&t(e),e):e}tapAsync(e,t){var r=this;return o(n.mark((function o(){return n.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(t){n.next=2;break}return n.abrupt("return",e);case 2:if(!r.isPromise(e)){n.next=6;break}return n.next=5,e;case 5:e=n.sent;case 6:if(!r.isFunction(t)){n.next=9;break}return n.next=9,t(e);case 9:return n.abrupt("return",e);case 10:case"end":return n.stop()}}),o)})))()}upon(e,t){return this.isPromise(e)||this.isAsyncFunction(t)?this.uponAsync(e,t):this.uponSync(e,t)}uponSync(e,t){return t&&this.isFunction(t)?t(e):e}uponAsync(e,t){var r=this;return o(n.mark((function o(){return n.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(t){n.next=2;break}return n.abrupt("return",e);case 2:if(!r.isPromise(e)){n.next=6;break}return n.next=5,e;case 5:e=n.sent;case 6:return n.abrupt("return",r.isFunction(t)?t(e):e);case 7:case"end":return n.stop()}}),o)})))()}isPromise(e){return!!e&&this.isFunction(e.then)}isFunction(e){return"function"===typeof e}isAsyncFunction(e){return this.isFunction(e)&&"AsyncFunction"===e.constructor.name}ifNullish(e,t){if(null===e||void 0===e)return t()}}},1987:function(e,t,r){"use strict";var n=r(1988),o=r(100),a=r(428);Object.defineProperty(t,"__esModule",{value:!0}),t.PromisePoolExecutor=void 0;const i=r(902),s=r(1991);t.PromisePoolExecutor=class{constructor(){this.tasks=[],this.items=[],this.errors=[],this.results=[],this.concurrency=10,this.handler=()=>{},this.errorHandler=void 0}withConcurrency(e){return i.tap(this,()=>{this.concurrency=e})}for(e){return i.tap(this,()=>{this.items=e})}withHandler(e){return i.tap(this,()=>{this.handler=e})}handleError(e){return i.tap(this,()=>{this.errorHandler=e})}hasReachedConcurrencyLimit(){return this.activeCount()>=this.concurrency}activeCount(){return this.tasks.length}start(){var e=this;return a(o.mark((function t(){return o.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",i.upon(e.validateInputs(),a(o.mark((function t(){return o.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.process());case 1:case"end":return t.stop()}}),t)})))));case 1:case"end":return t.stop()}}),t)})))()}validateInputs(){if("function"!==typeof this.handler)throw new Error("The first parameter for the .process(fn) method must be a function");if(!("number"===typeof this.concurrency&&this.concurrency>=1))throw new TypeError('"concurrency" must be a number, 1 or up. Received "'.concat(this.concurrency,'" (').concat(typeof this.concurrency,")"));if(!Array.isArray(this.items))throw new TypeError('"items" must be an array. Received '.concat(typeof this.items));if(this.errorHandler&&"function"!==typeof this.errorHandler)throw new Error("The error handler must be a function. Received ".concat(typeof this.errorHandler))}process(){var e=this;return a(o.mark((function t(){var r,a,i;return o.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=n(e.items),t.prev=1,r.s();case 3:if((a=r.n()).done){t.next=11;break}if(i=a.value,!e.hasReachedConcurrencyLimit()){t.next=8;break}return t.next=8,e.processingSlot();case 8:e.startProcessing(i);case 9:t.next=3;break;case 11:t.next=16;break;case 13:t.prev=13,t.t0=t.catch(1),r.e(t.t0);case 16:return t.prev=16,r.f(),t.finish(16);case 19:return t.abrupt("return",e.drained());case 20:case"end":return t.stop()}}),t,null,[[1,13,16,19]])})))()}processingSlot(){var e=this;return a(o.mark((function t(){return o.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.waitForTaskToFinish());case 1:case"end":return t.stop()}}),t)})))()}waitForTaskToFinish(){var e=this;return a(o.mark((function t(){return o.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Promise.race(e.tasks);case 2:case"end":return t.stop()}}),t)})))()}startProcessing(e){const t=this.createTaskFor(e).then(e=>{this.results.push(e),this.tasks.splice(this.tasks.indexOf(t),1)}).catch(r=>{if(this.tasks.splice(this.tasks.indexOf(t),1),this.errorHandler)return this.errorHandler(r,e);this.errors.push(s.PromisePoolError.createFrom(r,e))});this.tasks.push(t)}createTaskFor(e){var t=this;return a(o.mark((function r(){return o.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",t.handler(e));case 1:case"end":return r.stop()}}),r)})))()}drained(){var e=this;return a(o.mark((function t(){return o.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.drainActiveTasks();case 2:return t.abrupt("return",{results:e.results,errors:e.errors});case 3:case"end":return t.stop()}}),t)})))()}drainActiveTasks(){var e=this;return a(o.mark((function t(){return o.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Promise.all(e.tasks);case 2:case"end":return t.stop()}}),t)})))()}}},1988:function(e,t,r){var n=r(1989);e.exports=function(e){if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=n(e))){var t=0,r=function(){};return{s:r,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a,i=!0,s=!1;return{s:function(){o=e[Symbol.iterator]()},n:function(){var e=o.next();return i=e.done,e},e:function(e){s=!0,a=e},f:function(){try{i||null==o.return||o.return()}finally{if(s)throw a}}}}},1989:function(e,t,r){var n=r(1990);e.exports=function(e,t){if(e){if("string"===typeof e)return n(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(r):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?n(e,t):void 0}}},1990:function(e,t){e.exports=function(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}},1991:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PromisePoolError=void 0;class n extends Error{constructor(e,t){super(),this.item=t,this.name=this.constructor.name,this.message=this.messageFrom(e),Error.captureStackTrace(this,this.constructor)}static createFrom(e,t){return new this(e,t)}messageFrom(e){return e instanceof Error||"object"===typeof e?e.message:"string"===typeof e||"number"===typeof e?e.toString():""}}t.PromisePoolError=n},283:function(e,t,r){"use strict";r.d(t,"a",(function(){return m}));var n=r(77),o=r(71),a=r(4),i=r.n(a),s=r(93),c=r(83),l=r(6);const u=r.n(l)()("electron"),p=u?u.remote.dialog:null,d={container:{position:"relative",display:"flex",alignItems:"baseline"},button:{marginLeft:10},textField:{flex:1}};class m extends a.PureComponent{constructor(...e){super(...e),this._onChooseFolder=({title:e,message:t})=>{if(!p||!u)return;const r=u.remote.getCurrentWindow();p.showOpenDialog(r,{title:e,properties:["openDirectory","createDirectory"],message:t,defaultPath:this.props.defaultPath}).then(({filePaths:e})=>{e&&e.length&&this.props.onChange(e[0])})},this._getTitleAndMessage=e=>{const t=this.props.type;return"export"===t?{title:e._({id:"Choose an export folder"}),message:e._({id:"Choose where to export the game"})}:"create-game"===t?{title:e._({id:"Choose a folder for the new game"}),message:e._({id:"Choose where to create the game"})}:{title:void 0,message:void 0}}}render(){return i.a.createElement(o.I18n,null,({i18n:e})=>{const t=this._getTitleAndMessage(e);return i.a.createElement("div",{style:Object(n.a)(Object(n.a)({},d.container),{},{width:this.props.fullWidth?"100%":void 0})},i.a.createElement(s.b,{margin:"dense",style:d.textField,type:"text",hintText:t.title,value:this.props.value,onChange:(e,t)=>this.props.onChange(t)}),i.a.createElement(c.a,{label:i.a.createElement(o.Trans,{id:"Choose folder"}),primary:!1,style:d.button,onClick:()=>this._onChooseFolder(t)}))})}}},427:function(e,t,r){"use strict";r.d(t,"a",(function(){return c}));var n=r(6),o=r.n(n),a=r(520);const i=o()("fs"),s=Object(a.a)("archiver"),c=({path:e,outputFilename:t})=>{const r=s();return new Promise((n,o)=>{if(!i||!r)return o(new Error("Archiver unavailable"));const a=i.createWriteStream(t),s=r("zip",{zlib:{level:9}});a.on("close",()=>{console.log("Archive written at ".concat(t,", ").concat(s.pointer()," total bytes.")),n(t)}),s.on("error",e=>{o(e)}),s.pipe(a),s.directory(e,!1),s.finalize()})}},574:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(6);const o=r.n(n)()("electron"),a=o?o.ipcRenderer:null,i=(e,t,r)=>a?(a.removeAllListeners("local-file-upload-progress"),a.removeAllListeners("local-file-upload-done"),new Promise((n,o)=>{a.on("local-file-upload-progress",(e,t,n)=>{r(t,n)}),a.on("local-file-upload-done",(e,t)=>{if(t)return o(t);n()}),a.send("local-file-upload",e,t)})):Promise.reject("No support for local file upload")},577:function(e,t,r){"use strict";var n=r(77),o=r(6),a=r.n(o),i=r(883);const s=a()("fs"),c=a()("path"),l=a()("electron"),u=l?l.remote.dialog:null,p=e=>s?new Promise((t,r)=>{s.readFile(e,{encoding:"utf8"},(n,o)=>{if(n)return r(n);try{const e=JSON.parse(o);return t(e)}catch(a){return r(e+" is a corrupted/malformed file.")}})}):Promise.reject("Filesystem is not supported."),d=()=>{if(!u)return Promise.reject("Not supported");const e=l.remote.getCurrentWindow();return u.showOpenDialog(e,{title:"Open a project",properties:["openFile"],message:"If you want to open your GDevelop 4 project, be sure to save it as a .json file",filters:[{name:"GDevelop 5 project",extensions:["json"]}]}).then(({filePaths:e})=>e&&e.length?{fileIdentifier:e[0]}:null)},m=e=>{const t=e.fileIdentifier,r=c.dirname(t);return p(t).then(e=>Object(i.d)(e,{getReferencePartialObject:e=>p(c.join(r,e)+".json"),isReferenceMagicPropertyName:"__REFERENCE_TO_SPLIT_OBJECT",maxUnsplitDepth:3}).then(()=>({content:e})))},h=(e,t)=>{const r=e.fileIdentifier,n=r+".autosave";if(s.existsSync(n)){if(!t)return Promise.resolve(!0);try{const e=s.statSync(n).mtime.getTime();if(e>s.statSync(r).mtime.getTime())return Promise.resolve(!0)}catch(o){return console.error("Unable to compare *.autosave to project",o),Promise.resolve(!1)}return Promise.resolve(!1)}return Promise.resolve(!1)},f=e=>Promise.resolve(Object(n.a)(Object(n.a)({},e),{},{fileIdentifier:e.fileIdentifier+".autosave"}));var g=r(1931),v=r(5);t.a={internalName:"LocalFile",name:{id:"Local file system"},getFileMetadataFromAppArguments:e=>e[v.a]&&e[v.a].length?{fileIdentifier:e[v.a][0]}:null,createOperations:()=>({onOpenWithPicker:d,onOpen:m,hasAutoSave:h,onSaveProject:g.b,onSaveProjectAs:g.c,onAutoSaveProject:g.a,onGetAutoSave:f,getOpenErrorMessage:e=>({id:"Check that the file exists, that this file is a proper game created with GDevelop and that you have the authorizations to open it."})})}},69:function(e,t,r){"use strict";r.r(t),function(e){r.d(t,"create",(function(){return D}));var n=r(4),o=r.n(n),a=r(589),i=r(5),s=r(910),c=r(909),l=(r(15),r(38),r(879)),u=r(1944),p=r(1946),d=r(1947),m=r(1951),h=r(1954),f=r(1964),g=r(1965),v=r.n(g),b=r(1967),E=r(421),w=r(189),x=r(911),y=r(1979),P=r(1980),S=r(901),j=r(577),O=r(1981),k=r(1982);const C=e.gd,D=e=>{i.b.setUpContextMenu();const t=i.b.getArguments(),r=i.b.isDev();return o.a.createElement(x.a,{authentification:e,disableCheckForUpdates:!!t["disable-update-check"],makeEventsFunctionCodeWriter:b.a,eventsFunctionsExtensionWriter:y.a,eventsFunctionsExtensionOpener:P.a,resourceFetcher:k.a},({i18n:e})=>o.a.createElement(S.a,{appArguments:t,storageProviders:[j.a],defaultStorageProvider:j.a},({getStorageProviderOperations:t,storageProviders:n,initialFileMetadataToOpen:i,getStorageProvider:g})=>o.a.createElement(a.a,{i18n:e,renderMainMenu:e=>o.a.createElement(f.a,e),renderPreviewLauncher:(e,t)=>o.a.createElement(m.a,Object.assign({},e,{ref:t})),renderExportDialog:e=>o.a.createElement(s.a,Object.assign({},e,{exporters:Object(h.a)()})),renderCreateDialog:e=>o.a.createElement(c.a,Object.assign({},e,{examplesComponent:l.a,startersComponent:u.a})),renderGDJSDevelopmentWatcher:r?()=>o.a.createElement(O.a,null):null,storageProviders:n,getStorageProviderOperations:t,getStorageProvider:g,resourceSources:p.a,resourceExternalEditors:d.a,extensionsLoader:v()({gd:C,objectsEditorService:E.a,objectsRenderingService:w.a,filterExamples:!r}),initialFileMetadataToOpen:i})))}}.call(this,r(1))},879:function(e,t,r){"use strict";r.d(t,"b",(function(){return E})),r.d(t,"a",(function(){return w}));var n=r(71),o=r(4),a=r.n(o),i=r(2388),s=r(283),c=r(11),l=r(73),u=r(80),p=r(880),d=r(6),m=r.n(d),h=r(881),f=r(22),g=r(577);const v=m()("path");var b=m()("fs-extra");const E=(e,t,r)=>{Object(f.a)({message:e._({id:"Unable to create the game in the specified folder. Check that you have permissions to write in this folder: {outputPath} or choose another folder.",values:{outputPath:t}}),rawError:r,errorId:"local-example-creation-error"})};class w extends o.Component{constructor(...e){super(...e),this.state={exampleNames:null},this.createFromExample=(e,t)=>{const r=this.props.outputPath;b&&r&&Object(p.a)(n=>{try{b.mkdirsSync(r),b.copySync(v.join(n,t),r)}catch(o){return void E(e,r,o)}this.props.onOpen(g.a,{fileIdentifier:v.join(r,t+".json")}),Object(c.j)(t)})}}componentDidMount(){Object(p.a)(e=>{b.readdir(e,(e,t)=>{e?console.error("Unable to read examples:",e):this.setState({exampleNames:t.filter(e=>".DS_Store"!==e)},()=>this.props.onExamplesLoaded())})})}render(){return a.a.createElement(n.I18n,null,({i18n:e})=>a.a.createElement(l.a,{noMargin:!0},a.a.createElement(l.b,{expand:!0},a.a.createElement(l.a,{expand:!0},a.a.createElement(s.a,{fullWidth:!0,value:this.props.outputPath,onChange:this.props.onChangeOutputPath,type:"create-game"}))),a.a.createElement(i.a,null),a.a.createElement(l.b,null,a.a.createElement(l.a,null,a.a.createElement(u.a,null,a.a.createElement(n.Trans,{id:"Choose or search for an example to open:"})))),a.a.createElement(l.b,null,a.a.createElement(h.a,{exampleNames:this.state.exampleNames,onCreateFromExample:t=>this.createFromExample(e,t)}))))}}},880:function(e,t,r){"use strict";r.d(t,"a",(function(){return p}));var n=r(6),o=r.n(n);const a=o()("electron"),i=o()("path"),s=a?a.remote.app:null,c=o()("fs"),l=o()("process"),u=(e,t,r)=>c.access(e,c.constants.R_OK,n=>{n?r():t(e)}),p=e=>{if(!l||!c)return"";const t=s?s.getAppPath():l.cwd();u(i.join(t,"..","examples"),e,()=>{u(i.join(t,"..","..","app","resources","examples"),e,()=>{e(null)})})}},883:function(e,t,r){"use strict";r.d(t,"b",(function(){return i})),r.d(t,"d",(function(){return s})),r.d(t,"c",(function(){return c})),r.d(t,"a",(function(){return l}));var n=r(122),o=r(399),a=r.n(o);const i=(e,{pathSeparator:t,getArrayItemReferenceName:r,shouldSplit:n,isReferenceMagicPropertyName:o})=>{const a=[],i=(e,t)=>(a.push({reference:e,object:t}),{[o]:!0,referenceTo:e}),s=(e,o,a)=>{if(null!==e&&"object"===typeof e)if(Array.isArray(e))for(let c in e){const l=o+t+"*";if(n(l)){const n=e[c],o=r(n,a),u=a+t+o;e[c]=i(u,n),s(n,l,u)}else{const r=a+t+c;s(e[c],l,r)}}else for(let r in e){const c=o+t+r,l=a+t+r;if(n(c)){const t=e[r];e[r]=i(l,t),s(t,c,l)}else s(e[r],c,l)}};return s(e,"",""),a},s=(e,{isReferenceMagicPropertyName:t,getReferencePartialObject:r,maxUnsplitDepth:n})=>{const o=(e,a)=>{if(void 0!==n&&a>=n)return Promise.resolve();if(null!==e&&"object"===typeof e){const n=Object.keys(e);if(n)return Promise.all(n.map(n=>{const i=(e=>!0===e[t]?e:null)(e[n]);return i?r(i.referenceTo).then(t=>(e[n]=t,o(e[n],a+1))):o(e[n],a+1)})).then(()=>{})}return Promise.resolve()};return o(e,0)},c=e=>t=>e.has(t),l=e=>{const t={};return(r,o)=>{const i=r[e];if("string"!==typeof i)throw new Error("Property ".concat(e," is not a string"));t[o]=t[o]||{};const s=Object(n.a)(a()(i),e=>!!t[o][e]);return t[o][s]=!0,s}}},902:function(e,t,r){"use strict";e.exports=r(1985)}}]);
//# sourceMappingURL=local-app.549ccce5.chunk.js.map